<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Http service with token in react native | Maximiliano Opitz Turra &mdash; Software Engineer </title>
    <meta property="og:title" content="Http service with token in react native | Maximiliano Opitz Turra &mdash; Software Engineer " />
    <meta name="twitter:title" content="Http service with token in react native | Maximiliano Opitz Turra &mdash; Software Engineer " />

    <meta name="description" content="I'm a full stack coder, mainly in frameworks like Django and React Native. Also I've been working in teams with Git and standardizing the develops environments with Docker or Vagrant. Welcome to contact me in the bellow social networks.">
    <meta name="description" property="og:description" content="I'm a full stack coder, mainly in frameworks like Django and React Native. Also I've been working in teams with Git and standardizing the develops environments with Docker or Vagrant. Welcome to contact me in the bellow social networks." />
    <meta name="twitter:description" content="I'm a full stack coder, mainly in frameworks like Django and React Native. Also I've been working in teams with Git and standardizing the develops environments with Docker or Vagrant. Welcome to contact me in the bellow social networks." />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@your_handler" />
    
    <meta property="og:url" content="/docs/http-services-with-token-react-native.html" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Maximiliano Opitz Turra" />

    <meta name="copyright" content="Copyright by Maximiliano Opitz Turra. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="/assets/css/main.css">

    <link rel="canonical" href="/docs/http-services-with-token-react-native.html">

    <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

    <body>
        <div class="wrapper clear">
            <aside class="user-profile fixed" role="complementary">
    <a href=""><img class="avatar" src="/assets/perfil.jpg" /></a>
    <strong class="my-name">Maximiliano Opitz Turra</strong>
    <span class="my-job-title">Software Engineer</span>

    
        
        <div class="mainmenu">
            <a href="/" >Home</a>
            
                
            
                
            
                
            
                
                    <a href="/portfolio/" >Portfolio</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    

    <p class="about-me">I'm a full stack coder, mainly in frameworks like Django and React Native. Also I've been working in teams with Git and standardizing the develops environments with Docker or Vagrant. Welcome to contact me in the bellow social networks.</p>

    <ul>
        <li><a href="https://www.facebook.com/mturra"><svg title="facebook" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/mopitz199"><svg title="linkedin" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/mopitz199"><svg title="github" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/svg/social-icons.svg#github-icon"></use></svg></a></li><li><a href="https://www.youtube.com/channel/UC4vxgNgkH9san9rcuEMdDAA"><svg title="youtube" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/svg/social-icons.svg#youtube-icon"></use></svg></a></li>

        
            <li><a href="mailto:mopitz199@gmail.com"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder clear">
            <input type="text" id="search-input" placeholder="search for...">
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <article class="post single" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul class="clear">
            <li><time datetime="2017-08-30T13:46:00-03:00" itemprop="datePublished">30 Aug, 2017</time></li>
            
                
                <li class="cats">
                    
                        <a href="/categories/docs/">docs</a>
                    
                </li>
                
            
        </ul>
        <h2 itemprop="name headline">Http service with token in react native</h2>
    </header>

    <div class="post-content">
        <p>Hi everyone, today I would like to show you a way to use the React Native http service and put the token by default if we have it!</p>

<p>We can separte this tutorial in two parts:</p>

<ol>
  <li>Save our token</li>
  <li>Put the token in our header of every request</li>
</ol>

<p>Let’s start!</p>

<!--more-->

<h3 id="use-the-react-native-local-storage-to-save-our-token">1. Use the React Native local storage to save our token</h3>

<p>Save the token using <a href="https://github.com/sunnylqm/react-native-storage" title="Title">react-native-storage</a>:</p>

<p>After installing, we need to create an storage, I recommend to save in a global.js file that as the name says, you can write all your global variables</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre>    <span class="kr">import</span> <span class="nx">Storage</span> <span class="nx">from</span> <span class="s1">'react-native-storage'</span><span class="p">;</span>
    <span class="p">...</span>
    <span class="nx">global</span><span class="p">.</span><span class="nx">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Storage</span><span class="p">({</span>
    	<span class="na">size</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    	<span class="na">storageBackend</span><span class="p">:</span> <span class="nx">AsyncStorage</span><span class="p">,</span>
    	<span class="na">defaultExpires</span><span class="p">:</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span><span class="p">,</span>
    	<span class="na">enableCache</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">})</span>
  <span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Then we need to save your token when we get it, typically this will be after login(in the login page):</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="nx">Here</span> <span class="nx">we</span> <span class="nx">get</span> <span class="nx">the</span> <span class="nx">token</span><span class="p">(</span><span class="nx">using</span> <span class="nx">fetch</span><span class="p">)</span>
    <span class="p">...</span>
    <span class="kd">let</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">responseJson</span><span class="p">.</span><span class="nx">token</span>
    <span class="nx">global</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span>
    	<span class="na">key</span><span class="p">:</span> <span class="s1">'token'</span><span class="p">,</span>
    	<span class="na">data</span><span class="p">:</span> <span class="nx">token</span><span class="p">,</span>
    	<span class="na">expires</span><span class="p">:</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">3600</span>
    <span class="p">})</span>
  </code></pre></figure>

<p>We are done with this part, now that we have token saved globally we just need to use it!</p>

<h3 id="create-the-http-service-with-putting-the-token-by-default-on-each-request">2. Create the http service with putting the token by default on each request</h3>

<p>I created a file called <em>http.js</em> that contains just the function that we are going to create.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><pre>  <span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">utils</span> <span class="nx">from</span> <span class="s1">'./utils'</span><span class="p">;</span>

  <span class="kr">export</span> <span class="kd">function</span> <span class="nx">http</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">data</span><span class="p">){</span>
    <span class="kd">let</span> <span class="nx">fullUrl</span> <span class="o">=</span> <span class="s2">"localhost:8000/"</span>
    <span class="k">return</span> <span class="nx">global</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="nx">load</span><span class="p">({</span>
      <span class="na">key</span><span class="p">:</span> <span class="s1">'token'</span><span class="p">,</span>
    <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">ret</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">fullUrl</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="nx">method</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
          <span class="s1">'Authorization'</span><span class="p">:</span> <span class="s1">'Token '</span><span class="o">+</span><span class="nx">ret</span><span class="p">,</span>
          <span class="s1">'Accept'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">,</span>
          <span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
      <span class="p">})</span>
    <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">"We couldn't get the token"</span><span class="p">)</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">})</span>
  <span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>To use the function, we need to give the parameters(method, path an data) and that’s it! The function is returning the fetch callback, so you can check the React Native documentation to check how the fetch callback works.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="code"><pre>  <span class="c1">// Import http service</span>
  <span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">http</span> <span class="nx">from</span> <span class="s1">'../utils/http'</span><span class="p">;</span>
  <span class="p">...</span>
  <span class="kd">let</span> <span class="nx">jsonData</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span><span class="s2">"john"</span><span class="p">}</span>
  <span class="nx">resp</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="s1">'post'</span><span class="p">,</span> <span class="s1">'createPerson/'</span><span class="p">,</span> <span class="nx">jsonData</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">resp</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span>
    <span class="nx">resp</span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">"Here we have the response"</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="nx">resp</span><span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">"Here we have an error"</span><span class="p">)</span>
    <span class="p">});</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">"Here we couldn't get the token"</span><span class="p">)</span>
  <span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>We are calling a <em>POST</em> request where the url is <em>localhost:8000/cratePerson</em> and the data is a json objects <em>{name:”john”}</em>. Also we are capturing the response and the error to handle it! :D</p>

    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Http service with token in react native&p[summary]=Hi everyone, today I would like to show you a way to use the React Native http service and put the token by default if we have it!

We ca...&p[url]=/docs/http-services-with-token-react-native.html" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=/docs/http-services-with-token-react-native.html&text=Hi everyone, today I would like to show you a way to use the React Native http service and put the token by default if we have it!

We ca...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>


<aside class="comments" role="complementary">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = '/docs/http-services-with-token-react-native.html';
            this.page.identifier = '8/30/2017';
        };
        (function() {
            var d = document, s = d.createElement('script');

            s.src = '//your_disqus_site.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</aside>

            </main>
        </div>

        <script src="/assets/js/jquery-1.12.2.min.js"></script>
<script src="/assets/js/backtotop.js"></script>
<script src="/assets/js/lunr.min.js"></script>
<script src="/assets/js/lunr-feed.js"></script>
<script src="/assets/js/jquery.fitvids.js"></script>
<script src="/assets/js/svg4everybody.min.js"></script>
<script src="/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-XXXXXXX-2', 'auto');
        ga('send', 'pageview');
    </script>

    </body>
</html>